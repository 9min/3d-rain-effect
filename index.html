<!DOCTYPE html>
<html>
  <head>
    <title>3D Rain Effect</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="src/css/styles.css" />
    <script src="src/js/three.min.js"></script>
  </head>
  <body>
    <h1 class="hidden">3D Rain Effect</h1>
    <main id="app" class="contents">
      <aside class="button_wrap">
        <button type="button" id="btnAudioOn" class="btn_audio hide">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <path d="M5 17h-5v-10h5v10zm2-10v10l9 5v-20l-9 5zm11.008 2.093c.742.743 1.2 1.77 1.198 2.903-.002 1.133-.462 2.158-1.205 2.9l1.219 1.223c1.057-1.053 1.712-2.511 1.715-4.121.002-1.611-.648-3.068-1.702-4.125l-1.225 1.22zm2.142-2.135c1.288 1.292 2.082 3.073 2.079 5.041s-.804 3.75-2.096 5.039l1.25 1.254c1.612-1.608 2.613-3.834 2.616-6.291.005-2.457-.986-4.681-2.595-6.293l-1.254 1.25z"/>
          </svg>
        </button>
        <button type="button" id="btnAudioOff" class="btn_audio">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <path d="M3 9v6h-1v-6h1zm13-7l-9 5v2.288l7-3.889v13.202l-7-3.889v2.288l9 5v-20zm-11 5h-5v10h5v-10zm17.324 4.993l1.646-1.659-1.324-1.324-1.651 1.67-1.665-1.648-1.316 1.318 1.67 1.657-1.65 1.669 1.318 1.317 1.658-1.672 1.666 1.653 1.324-1.325-1.676-1.656z"/>
          </svg>
        </button>
      </aside>
    </main>
    <script src="src/js/rain.js"></script>
    <script>
      const rain = new Rain({
        target: document.querySelector('#app'),
        resources: {
          cloud: 'src/images/cloud.png',
          drop: 'src/images/drop.png',
          audio: 'src/sounds/rain.wav',
        },
      });
      const mobileKeyWords = [
        'iPhone',
        'iPod',
        'BlackBerry',
        'Android',
        'Windows CE',
        'LG',
        'MOT',
        'SAMSUNG',
        'SonyEricsson',
        'Windows Phone',
      ];
      let eventName = 'click';

      for (let word in mobileKeyWords) {
        if (navigator.userAgent.match(mobileKeyWords[word])) {
          eventName = 'touchend';
        }
      }

      const btnAudioOn = document.querySelector('#btnAudioOn');
      const btnAudioOff = document.querySelector('#btnAudioOff');

      btnAudioOn.addEventListener(eventName, (evt) => {
        rain.mute(true);
        btnAudioOn.classList.add('hide');
        btnAudioOff.classList.remove('hide');
        evt.stopPropagation();
      });

      btnAudioOff.addEventListener(eventName, (evt) => {
        rain.mute(false);
        btnAudioOn.classList.remove('hide');
        btnAudioOff.classList.add('hide');
        evt.stopPropagation();
      });
    </script>
  </body>
</html>
